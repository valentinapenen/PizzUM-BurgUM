<!doctype html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title th:text="'Pedido #' + ${pedido.idPedido} + ' — PizzUM & BurgUM'">Pedido — PizzUM & BurgUM</title>

    <link rel="stylesheet" href="../static/css/base.css"   th:href="@{/css/base.css}">
    <link rel="stylesheet" href="../static/css/pedido.css" th:href="@{/css/pedido.css}">
</head>
<body>

<header>
    <div class="container nav">
        <div class="nav__brand">
            <img class="logo" alt="PizzUM & BurgUM"
                 src="https://i.postimg.cc/qMLhFSwz/Logo-final-removebg-preview.png" />
            <strong>PizzUM &amp; BurgUM</strong>
        </div>
        <nav class="nav__links">
            <a class="pill" th:href="@{/}">Inicio</a>
            <a class="pill" th:href="@{/favoritos}">Favoritos</a>
            <a class="pill" th:href="@{/historial}">Historial</a>
            <a class="pill" th:href="@{/usuario}">Usuario</a>
            <a class="pill active" th:href="@{/pedido}">Pedido</a>
        </nav>
    </div>
</header>

<main class="container">
    <section class="pedido-header">
        <h1 th:text="'Pedido #' + ${pedido.idPedido}">Pedido</h1>
        <div class="estado">
            <span class="dot"></span>
            <span th:text="${pedido.estado}">En preparación</span>
        </div>
    </section>

    <div class="timeline">
        <div th:classappend="${pedido.estado.name() == 'EN_COLA'} ? ' step-activa' : ' step-done'" class="step"><span class="dot">1</span> En cola</div>
        <div th:classappend="${pedido.estado.name() == 'EN_PREPARACION'} ? ' step-activa' : ' step-done'" class="step"><span class="dot">2</span> En preparación</div>
        <div th:classappend="${pedido.estado.name() == 'EN_CAMINO'} ? ' step-activa' : ''" class="step"><span class="dot">3</span> En camino</div>
        <div th:classappend="${pedido.estado.name() == 'ENTREGADO'} ? ' step-activa' : ''" class="step"><span class="dot">4</span> Entregado</div>
    </div>

    <div class="card">
        <h2>Detalle del pedido</h2>

        <div class="items">
            <article class="item" th:each="c : ${pedido.creaciones}">
                <img class="thumb" th:src="${c.productoBase.imagenUrl}" th:alt="${c.productoBase.nombre}" />
                <div>
                    <h4 th:text="${c.productoBase.nombre}">Producto base</h4>
                    <p th:text="${#strings.listJoin(c.toppings![nombre], ', ')}">Toppings</p>
                </div>
                <div class="precio" th:text="'$' + ${c.precioTotal}">$0</div>
            </article>
        </div>

        <div class="totales">
            <div class="fila"><span>Subtotal</span><strong th:text="'$' + ${pedido.calcularTotal()}">$0</strong></div>
            <div class="fila"><span>Envío</span><strong>$50</strong></div>
            <div class="fila total"><span>Total</span><strong th:text="'$' + (${pedido.calcularTotal()} + 50)">$0</strong></div>
        </div>

        <div class="acciones">
            <form th:action="@{'/pedido/' + ${pedido.idPedido} + '/editar'}" method="get">
                <button type="submit" class="btn btn-primario">Editar pedido</button>
            </form>

            <form th:action="@{'/pedido/' + ${pedido.idPedido} + '/cancelar'}" method="post">
                <button type="submit" class="btn btn-peligro">Cancelar pedido</button>
            </form>

            <a class="btn btn-fantasma" th:href="@{/historial}">Volver</a>
        </div>
    </div>
</main>
</body>
</html>

